<div class="rw-assets">

    <button class="btn btn-block btn-primary" ui-sref="project.asset-new()">Add New Asset</button>

    <hr/>

    <!-- Assets Table -->
    <table st-table="vm.assets" st-pipe="vm.pipe" class="table table-striped" st-refresh>
        <colgroup>
            <col width="42">
            <col width="55">
            <col width="60">
            <col>
            <col>
            <col width="160">
            <col width="55">
            <col width="45">
            <col width="45">
        </colgroup>
        <thead>
            <tr>
                <th>ID</th>
                <th>Type</th>
                <th>Size</th>
                <th>File</th>
                <th>Tags</th>
                <th>Created</th>
                <th><abbr title="Submitted?">Sub?</abbr></th>
                <th></th>
                <th></th>
            </tr>
            <tr>
                <th></th>
                <th>
                    <select st-search="media_type" class="glyphicon-inline">
                        <option value="">&#x002a;</option>
                        <option value="audio">&#xe035;</option>
                        <option value="photo">&#xe060;</option>
                        <option value="video">&#xe059;</option>
                        <option value="text">&#xe241;</option>
                    </select>
                </th>
                <th></th>
                <th></th>
                <th>
                    <!-- TODO: Make this a multi-select? -->
                    <select st-search="tag_id">
                        <option value="">All</option>
                        <option ng-repeat="tag in vm.tags" value="{{ tag.id }}">{{ tag.value }}</option>
                    </select>
                </th>
                <th></th>
                <th>
                    <select st-search="submitted" class="glyphicon-inline">
                        <option value="undefined">&#x002a;</option>
                        <option value="true">&#xe067;</option>
                        <option value="false">&#xe157;</option>
                    </select>
                </th>
                <th></th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="row in vm.assets">
                <td>{{ row.id }}</td>
                <td class="text-center">

                    <span
                        class="glyphicon"
                        ng-class="{
                            'glyphicon-headphones': row.media_type == 'audio',
                            'glyphicon-picture': row.media_type == 'photo',
                            'glyphicon-facetime-video': row.media_type == 'video',
                            'glyphicon-text-size': row.media_type == 'text',
                        }"
                    ></span>

                </td>
                <td ng-if="row.media_type == 'audio'">
                    <!-- Feel free to prepend `HH:` to the format string to show hours -->
                    {{ row.audio_length_in_seconds | secondsToDateTime | date : 'mm:ss' }}
                </td>
                <td ng-if="row.media_type != 'audio'">
                    <!-- IDEA: Show filesize i/o length for image assets? -->
                </td>
                <td ng-if="row.media_type == 'audio'" class="no-ellipsis">

                    <audio controls preload="none">
                        <source ng-src="{{ vm.getFileUrl( row.file ) }}">
                    </audio>

                </td>
                <td ng-if="row.media_type != 'audio'" class="no-ellipsis">

                    <a
                        href="{{ vm.getFileUrl( row.file ) }}"
                        title="{{ row.filename }}"
                        target="_blank"
                    >{{ row.filename }}</a>

                </td>
                <td>
                    <!-- Use span and {{ $last ? '' : ', ' }} if you want the tags on one line -->
                    <div ng-repeat="tag_id in row.tag_ids">
                        {{ vm.getTag( tag_id ).value }}
                    </div>
                </td>
                <!-- Assets created through the Django admin panel have milliseconds -->
                <td>{{ row.created | date : 'yyyy-MM-dd HH:mm:ss' }}</td>
                <!-- We are populating the table using cache.clean, but here, we need to target cache.dirty -->
                <td>
                    <div class="checkbox">
                        <label>
                            <input type="checkbox"
                                ng-model="vm.getAsset( row.id ).dirty.submitted"
                                ng-change="vm.toggleSubmitted( row.id, vm.getAsset( row.id ).dirty.submitted )">
                        </label>
                    </div>
                </td>
                <td class="no-ellipsis"><btn-edit ui-sref="project.asset-edit({ asset_id: row.id })"/></td>
                <td class="no-ellipsis"><btn-delete ng-click="vm.deleteAsset( row.id )"/></td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td st-pagination="" st-items-by-page="20" colspan="9">
                </td>
            </tr>
        </tfoot>
    </table>

</div>
